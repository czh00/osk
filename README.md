OSK - 高性能自定義虛擬鍵盤 (WPF)
一個基於 WPF 開發的高性能虛擬鍵盤，專為 Windows 環境設計。除了基本的按鍵輸入，本專案特別針對 中文輸入法 (IME) 狀態偵測、小狼毫/注音切換邏輯 以及 臨時英文模式 進行了深度優化。
🌟 主要特色
非激活視窗 (No-Activate UI)：點擊鍵盤不會奪取目前輸入目標視窗的焦點。
實體鍵盤同步：使用低階鍵盤掛鉤 (Global Keyboard Hook)，即時反應實體鍵盤的按下/放開狀態。
智能 IME 偵測：透過 IMM32 API 自動偵測前景視窗的輸入模式，動態切換 注音/英文字母 顯示。
專屬模式功能：
Mode 鍵：快速發送 Shift 訊號以切換系統輸入法（如：小狼毫 Rime 狀態）。
臨時英文模式：在中文模式下按 Shift 啟動，支援「首字大寫、後續小寫」的快速英文輸入。
Fn 模式：擴充功能鍵（F1-F12）、媒體鍵，並支援自定義組合鍵映射。
安全性與便利性：內建「安全選單」模擬，提供鎖定、登出、工作管理員等快速選項。
自定義外觀：支援透明度調整、視窗縮放與拖曳定位。
🛠 技術重點
1. 視窗特性與注入
透過 Win32 API 設置 WS_EX_NOACTIVATE 擴充樣式，確保 OSK 始終不會成為 ForegroundWindow，並使用 keybd_event 進行按鍵事件注入。
2. 輸入法狀態監控
利用 GetGUIThreadInfo 鎖定目前真正擁有輸入焦點的控制項 hwnd，精準獲取其輸入上下文 (HIMC)，實現介面顯示與系統輸入法的完全同步。
3. 低階鍵盤掛鉤 (WH_KEYBOARD_LL)
監聽系統層級的鍵盤事件，用於解決虛擬鍵盤常見的狀態同步問題，並處理複雜的「臨時英文模式」邏輯。
4. 系統托盤整合
程式啟動後會縮小至系統托盤（右下角小圖示），支援點擊切換顯示/隱藏，並從 EXE 資源中自動提取圖示以保持視覺一致。
🚀 快速開始
環境需求
.NET 6.0 或更高版本
Windows 10/11 (由於使用大量 Win32 API，不支援其他作業系統)
建置步驟
複製此儲存庫。
使用 Visual Studio 打開 .sln 檔案。
確保 Assets/app.ico 的建置動作設定為 Resource（或確保專案設定中已指定應用程式圖示）。
按下 F5 進行建置與執行。
⌨️ 快捷鍵說明
Fn + Mode：切換「本地預覽模式」，只改變鍵盤顯示而不影響系統輸入法。
Fn + Tab：開啟安全選單（替代 Ctrl+Alt+Del 常用功能）。
Fn + Backspace：發送 Delete 鍵。
📄 授權
本專案採用 MIT 授權。
